{% extends "base.html" %}

{% block header %}
{% include "components/polis_header.html" %}
{% endblock header %}

{% block content %}
<main id="content" x-data="{showHelp: false}">
    
    <section id="conversaciones">
        <div class="container mx-auto px-2 lg:px-6 py-[20px] lg:py-[60px] xl:px-4">
          <div class="grid grid-cols-1 gap-8 xl:grid-cols-12">
            <div class="xl:col-span-12 ">
                <div class="flex flex-col lg:flex-row lg:items-center px-2 lg:px-0 mb-4 xl:mb-6">
                    <span class="text-base font-medium uppercase  text-teal-600 lg:text-xl">Despolarizar</span>
                    <h3 class="lg:ml-5 w-full  flex items-center text-3xl lg:text-[40px] font-semibold leading-tight text-teal-600">
                        <span>{{object.topic}}</span>
                        <button @click="showHelp = !showHelp" class="ml-auto">
                            <span class="material-symbols-outlined text-3xl">help_outline</span>
                        </button>  
                    </h3>
                
                    
                </div>

                <!-- overlay about -->
    
            <div class="container mx-auto px-6 py-[60px] xl:px-4 bg-teal-50" x-show="false">
            <div class="grid grid-cols-1 gap-8 xl:grid-cols-12">
                <button @click="showHelp = !showHelp" class="absolute top-0 right-0 text-white focus:outline-none m-4">
                    <span class="material-symbols-outlined text-2xl">close</span>
                </button>
                <div class="grid grid-cols-1 gap-8 xl:grid-cols-12">
                    {% include "components/about_content.html" %}
                </div>
                </div>
            </div>

                
                <div id="polis-container" class="rounded-3xl bg-white p-2 lg:px-14 lg:py-6 shadow-[6px_6px_14px_rgba(0,0,0,0.05)]">
                </div>
        
                <script type="text/javascript">
                    function buildEmbedDiv(dataAttributes) {
                        var dataAttributesString = '';
                        for (var key in dataAttributes) {
                            if (dataAttributes.hasOwnProperty(key)) {
                                dataAttributesString += "data-" + key + "='" + dataAttributes[key] + "' ";
                            }
                        }
                        return "<div class='polis' " + dataAttributesString + "></div>";
                    }
                
                    var embedScript = document.createElement("script");
                    embedScript.setAttribute("src", "{{object.instance.url}}/embed.js");
                
                    var polisContainer = document.getElementById('polis-container');
                    {% load i18n %}
                    {% get_current_language as LANGUAGE_CODE %}
                    var dataAttributes = {
                        "site_id": "{{object.instance.site_id}}",
                        "page_id": "{{object.slug}}",
                        "topic": "{{object.topic}}",
                        "parent_url": "{{ request.path }}",
                        "xid": "{{participant.id}}",
                        "x_name": "{{participant.nick_name|default_if_none:''}}",
                        "x_email": "{{participant.email|default_if_none:''}}",
                        "x_profile_image_url": "{{participant.avatar_url|default_if_none:''}}",
                        "border": "{{object.border}}",
                        "border_radius": "{{object.border_radius}}",
                        "padding": "{{object.padding}}",
                        "height": "{{object.height|default_if_none:'930'}}",
                        "ucsf": "{{object.show_footer|yesno:'true,false'}}",
                        "ucsh": "{{object.show_help|yesno:'true,false'}}",
                        "ucsd": "{{object.show_description|yesno:'true,false'}}",
                        "ucst": "{{object.show_topic|yesno:'true,false'}}",
                        "bg_white": "{{object.bg_white|yesno:'true,false'}}",
                        "ui_lang": "{{LANGUAGE_CODE}}",
                        "style_btn": "{{object.color_primary|default_if_none:'#e25666'}}",
                        // Add other data attributes here as needed
                    };
                    polisContainer.innerHTML = buildEmbedDiv(dataAttributes);
                    polisContainer.appendChild(embedScript);
                </script>   
            </div>
        </div>
    </section>
    
    
   
</main>
{% endblock content%}

{% block footer %}
{% include "components/polis_footer.html" %}
{% endblock footer %}