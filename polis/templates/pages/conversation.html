{% extends "base.html" %}

{% block content %}
<section>
    <title>Participant Form</title>
    {{ participant.nombre }}
    <div class="flex justify-center items-center">
     
        <div class="max-w-4xl w-full aspect-w-16 aspect-h-9 my-8">
            <div id="polis-container">
            </div>
        </div>
        <script type="text/javascript">
            function buildEmbedDiv(dataAttributes) {
                var dataAttributesString = '';
                for (var key in dataAttributes) {
                    if (dataAttributes.hasOwnProperty(key)) {
                        dataAttributesString += "data-" + key + "='" + dataAttributes[key] + "' ";
                    }
                }
                return "<div class='polis' " + dataAttributesString + "></div>";
            }
        
            var embedScript = document.createElement("script");
            embedScript.setAttribute("src", "{{object.instance.url}}/embed.js");
        
            var polisContainer = document.getElementById('polis-container');
            var dataAttributes = {
                "site_id": "{{object.instance.site_id}}",
                "page_id": "{{object.slug}}",
                "parent_url": "{{ request.path }}",
                "xid": "{{participant.id}}",
                "x_name": "{{participant.name|default_if_none:''}}",
                // Add other data attributes here as needed
            };
            polisContainer.innerHTML = buildEmbedDiv(dataAttributes);
            polisContainer.appendChild(embedScript);
        </script>
        
      
    </div>
    
</section>
{% endblock content%}